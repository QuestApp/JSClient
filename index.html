<html>
<head>
	<title>Quest App Landing</title>
	<script src="assets/js/Vendor/jquery-1.11.0.min.js"></script>
	<script src="assets/js/Vendor/jquery.querystring.js"></script>
</head>
<body>
	<form action="quest.html" method="get" enctype="text/plain" id="form">
		<p>
			<strong>Quest Server Address</strong><br>
			<input type="text" id="srv" name="srv" value="http://server.quest.jeffenmau.org" required />
		</p>
		<p>
			<strong>Quest ID</strong><br>
			<input type="text" id="questId" name="questId" required/>
		</p>
		<input type="hidden" id="authDigest" name="authDigest"/>
		<button type="submit" value="Load Quest">Load Quest</button>
	</form>
	<form>
		<p>
			<strong>User Name</strong><br>
			<input type="text" id="user" name="user"/>
		</p>
		<p>
			<strong>Password</strong><br>
			<input type="password" id="password" name="password"/>
		</p>		
	</form>
	<script type="text/javascript">
	function valFromQueryParam(param){
		if($.QueryString[param]){
			$('#'+param).val($.QueryString[param]);
		}
	}

	function base_auth() {
	  var tok = $("#user").val() + ':' + $("#password").val();
	  var hash = btoa(tok);
	  return hash;
	}

	$("#form").submit(function(e){
	    e.preventDefault();
	    var form = this;
	    $("#authDigest").val(base_auth())
        form.submit(); // submit bypassing the jQuery bound event
	});

	$(function(){
		valFromQueryParam('srv');
		valFromQueryParam('questId');
		valFromQueryParam('authDigest');
		valFromQueryParam('user');
		valFromQueryParam('password');
	})
	</script>
</body>
</html>