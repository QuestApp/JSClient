<!DOCTYPE html>
<html lang="en">
	<head>
	    <meta charset="utf-8">
	    <meta http-equiv="X-UA-Compatible" content="IE=edge">
	    <meta name="viewport" content="width=device-width, initial-scale=1">
		<title>Quest App Landing</title>

	    <!-- Bootstrap -->
	    <link href="assets/css/bootstrap.lumen.min.css" rel="stylesheet">
	
	    <style type="text/css">
	      html, body, #view, #container-main, #map-canvas {
	        height: 100%;
	      }
	      body {
	        padding-top: 52px;
	        /*padding-bottom: 52px;*/
	        /*margin-bottom: 50px;*/
	      }
	      #view {
	        margin-top: 10px;
	        margin-bottom: 10px;
	      }
	  
		  #view .table {
			  margin-bottom: 60px;
		  }
	  
		  #question-container {
			  margin-bottom: 60px;
		  }
	    </style>
	</head>
<body>
	<form action="quest.html" method="get" enctype="text/plain" id="form">
		<p>
			<strong>Quest Server Address</strong><br>
			<input type="text" id="srv" name="srv" value="http://server.quest.jeffenmau.org" required />
		</p>
		<p>
			<strong>Quest ID</strong><br>
			<input type="text" id="questId" name="questId" required/>
		</p>
		<input type="hidden" id="authDigest" name="authDigest"/>
		<button type="submit" value="Load Quest">Load Quest</button>
	</form>
	<form>
		<p>
			<strong>User Name</strong><br>
			<input type="text" id="user" name="user"/>
		</p>
		<p>
			<strong>Password</strong><br>
			<input type="password" id="password" name="password"/>
		</p>		
	</form>

    <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
    <script src="assets/js/Vendor/jquery-1.11.0.min.js"></script>
    <!-- Our QueryString jQuery extension -->
    <script src="assets/js/Vendor/jquery.querystring.js"></script>
    <script src="assets/js/Vendor/jquery.cookie.js"></script>
    <!-- Include all compiled plugins (below), or include individual files as needed -->
    <script src="assets/js/Vendor/bootstrap.min.js"></script>

	<script type="text/javascript">
	function valFromQueryParam(param){
		if($.QueryString[param]){
			$('#'+param).val($.QueryString[param]);
		}
	}

	function base_auth() {
	  var tok = $("#user").val() + ':' + $("#password").val();
	  var hash = btoa(tok);
	  return hash;
	}

	$("#form").submit(function(e){
	    e.preventDefault();
	    var form = this;
	    $("#authDigest").val(base_auth())
		location.replace('quest.html?' + $("#form").serialize());
        //form.submit(); // submit bypassing the jQuery bound event
	});

	$(function(){
		valFromQueryParam('srv');
		valFromQueryParam('questId');
		valFromQueryParam('authDigest');
		valFromQueryParam('user');
		valFromQueryParam('password');
	})
	</script>
	
	<script>
	  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

	  ga('create', 'UA-55823751-1', 'auto');
	  ga('send', 'pageview');

	</script>
</body>
</html>